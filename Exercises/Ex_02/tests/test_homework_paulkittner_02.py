from ..homework_paulkittner_02 import Protein_attributions


def test_get_sequence():
    p1 = Protein_attributions("P32249")
    gpcr_sequence = p1.get_sequence()
    correct_gpcr_seq = "MDIQMANNFTPPSATPQGNDCDLYAHHSTARIVMPLHYSLVFIIGLVGNLLALVVIVQNRKKINSTTLYSTNLVISDILFTTALPTRIAYYAMGFDWRIGDALCRITALVFYINTYAGVNFMTCLSIDRFIAVVHPLRYNKIKRIEHAKGVCIFVWILVFAQTLPLLINPMSKQEAERITCMEYPNFEETKSLPWILLGACFIGYVLPLIIILICYSQICCKLFRTAKQNPLTEKSGVNKKALNTIILIIVVFVLCFTPYHVAIIQHMIKKLRFSNFLECSQRHSFQISLHFTVCLMNFNCCMDPFIYFFACKGYKRKVMRMLKRQVSVSISSAVKSAPEENSREMTETQMMIHSKSSNGK"

    assert gpcr_sequence == correct_gpcr_seq


def test_get_sequence_empty_string():
    p1 = Protein_attributions("")
    gpcr_sequence = p1.get_sequence()
    correct_gpcr_seq = ""

    assert gpcr_sequence == correct_gpcr_seq

def test_get_sequence_wrong_index():
    p1 = Protein_attributions("I DONT THINK I AM A PROTEIN :)")
    gpcr_sequence = p1.get_sequence()
    correct_gpcr_seq = ""

    assert gpcr_sequence == correct_gpcr_seq

def test_get_hydropathy_dict():
    p1 = Protein_attributions("P32249")
    dict_aa_prop = p1.get_hydropathy_dict("../data/amino_acid_properties.csv")
    cor_dict = {'A': 1.8, 'R': -4.5, 'N': -3.5, 'D': -3.5, 'C': 2.5, 'E': -3.5, 'Q': -3.5, 'G': -0.4, 'H': -3.2, 'I': 4.5, 'L': 3.8, 'K': -3.9, 'M': 1.9, 'F': 2.8, 'P': -1.6, 'S': -0.8, 'T': -0.7, 'W': -0.9, 'Y': -1.3, 'V': 4.2}
    assert dict_aa_prop == cor_dict


def test_calc_hydro_avg():
    p1 = Protein_attributions("P32249")
    p1.get_hydropathy_dict("../data/amino_acid_properties.csv")
    p1.get_sequence()
    avg_hyd = p1.calc_hydro_avg(5)
    cor_avg_hyd = [1.9, -0.8, 0.9666666666666667, -0.15000000000000002, 0.25999999999999995, 0.24, 0.24000000000000005, -1.3599999999999999, -0.1, -0.6200000000000001, -1.3, -0.9199999999999999, -0.3800000000000001, -0.5800000000000001, -0.5800000000000001, -0.5800000000000001, -0.96, -0.8800000000000001, -1.94, -2.5, -1.6800000000000002, -1.6800000000000002, -0.8400000000000001, -0.4, 0.6599999999999999, -0.4800000000000001, -0.4200000000000001, -1.34, -1.2200000000000002, -1.2200000000000002, -1.48, 0.05999999999999996, 1.06, 1.58, 0.9, 2.56, 1.02, -0.08000000000000011, -0.6200000000000001, 0.45999999999999985, 0.54, 1.7399999999999998, 2.9, 3.96, 3.12, 3.04, 3.3199999999999994, 2.34, 0.7399999999999999, 1.5799999999999998, 1.5799999999999998, 1.1, 1.94, 3.4799999999999995, 3.5599999999999996, 3.7, 4.18, 2.72, 1.1799999999999997, -0.5600000000000002, -2.2399999999999998, -3.8600000000000003, -2.2600000000000002, -2.2600000000000002, -1.52, -0.8800000000000001, -0.24, -0.38000000000000006, 0.05999999999999992, 0.05999999999999996, 0.05999999999999992, -0.5, -0.5, 0.6, 1.6600000000000001, 1.64, 1.64, 1.7799999999999998, 1.7, 1.3599999999999999, 1.38, 1.9400000000000006, 1.4, 1.4, 0.52, 0.5200000000000001, -0.24000000000000005, 0.3, -0.09999999999999995, -0.040000000000000036, -0.16, 1.1, 0.58, 0.13999999999999996, 0.96, 0.5199999999999999, -0.02000000000000004, -1.3, -0.31999999999999995, -0.9600000000000002, -0.9600000000000002, -0.41999999999999993, 1.2399999999999998, 0.8400000000000001, 0.019999999999999928, 1.6199999999999999, 1.1199999999999999, 0.72, 0.9800000000000001, 2.7199999999999998, 2.3800000000000003, 2.2600000000000002, 2.8, 1.3399999999999999, 0.36, -0.45999999999999996, 0.16, -0.8200000000000001, 0.72, 0.15999999999999998, 0.9799999999999999, 1.0, 0.9400000000000001, 0.6, 2.0599999999999996, 1.34, 1.86, 1.3, -0.1, -0.3, 0.76, 0.21999999999999997, 1.7600000000000002, 3.5, 2.3, 1.0799999999999996, 1.48, -0.26000000000000006, -1.36, -1.4200000000000002, -1.8800000000000001, -1.7400000000000002, -1.6199999999999999, -2.2600000000000002, -0.6599999999999999, -0.58, -2.12, -0.9800000000000001, -0.86, -1.8400000000000003, -0.3, 0.8400000000000002, 1.3800000000000001, 2.72, 3.6399999999999997, 2.62, 3.02, 2.88, 3.16, 2.8800000000000003, 3.4200000000000004, 1.8200000000000003, 0.9200000000000002, 0.8399999999999999, -0.040000000000000036, 0.3599999999999999, 1.8199999999999996, 2.8600000000000003, 1.4, 1.4, 1.02, 0.09999999999999995, -1.58, -1.58, -1.9600000000000002, -1.9799999999999998, -2.52, -2.6399999999999997, -1.0399999999999998, -0.4800000000000001, -0.34, 0.74, 0.9399999999999998, -0.21999999999999997, -0.39999999999999997, -1.6, -1.4200000000000002, -1.4200000000000002, -1.86, -1.6800000000000002, -1.7600000000000002, -2.48, -1.02, -0.6399999999999999, -0.68, 1.0, 1.92, 1.92, 2.1599999999999997, 2.7, 2.3, 2.1, 2.2399999999999998, 2.2399999999999998, 1.6199999999999999, 1.9600000000000002, 2.16, 0.9399999999999998, 1.7799999999999998, 2.94, 3.0, 3.1399999999999997, 4.220000000000001, 4.36, 3.96, 2.8, 1.7399999999999998, 0.2800000000000001, 0.27999999999999997, 0.2800000000000001, 1.04, 0.42000000000000004, 1.8799999999999997, 1.54, 0.13999999999999985, -0.5, 0.6399999999999999, -0.9, -2.16, -1.9600000000000002, -2.1399999999999997, -1.7399999999999998, -1.1, -1.1, -1.1800000000000002, -1.02, -1.86, -0.8800000000000002, -0.8800000000000001, -0.8800000000000001, -1.5, -1.06, -1.1400000000000001, -1.1400000000000001, -0.5, 1.18, 1.72, 1.72, 3.3200000000000003, 4.36, 4.3, 4.24, 4.04, 3.9799999999999995, 3.84, 3.5, 3.22, 2.5200000000000005, 1.36, 0.3399999999999999, -0.8000000000000002, -0.5199999999999999, -0.020000000000000063, 1.2, 2.3600000000000003, 2.3, 0.8200000000000001, 0.8399999999999999, 0.8399999999999999, -0.8400000000000002, -0.9199999999999999, 0.4800000000000001, -0.8, -1.1400000000000001, -0.5199999999999999, -0.44000000000000006, -0.64, 1.02, -0.24000000000000005, 0.41999999999999993, 0.96, -0.30000000000000004, -1.9600000000000002, -1.9, -2.56, -1.8399999999999999, -1.8399999999999999, -0.040000000000000036, 0.44000000000000006, 1.3599999999999999, 0.15999999999999998, 1.42, 0.37999999999999995, 1.38, 1.1199999999999999, 2.5200000000000005, 2.3400000000000003, 1.78, 1.4999999999999998, 0.2999999999999998, 0.039999999999999945, 0.15999999999999998, 1.2399999999999998, -0.020000000000000018, 0.36000000000000004, 0.42000000000000004, 0.82, 0.18000000000000002, 1.44, 2.3200000000000003, 2.12, 1.72, 1.1999999999999997, 0.5599999999999999, -0.26000000000000006, -1.4, -2.8, -2.8, -1.8799999999999997, -1.2400000000000002, -1.36, -0.07999999999999999, 1.4599999999999997, -0.16000000000000006, -1.44, -1.2400000000000002, -0.7799999999999999, -1.7, -0.07999999999999989, 0.6600000000000001, 2.2600000000000002, 1.2600000000000002, 1.2600000000000002, 0.78, 1.78, 0.10000000000000009, 0.10000000000000005, 0.62, -0.05999999999999996, -1.6, -1.52, -2.06, -2.58, -3.16, -3.16, -2.08, -1.52, -2.06, -1.3, -1.3, -1.3, -0.7800000000000001, 0.82, 0.31999999999999995, 0.8600000000000001, -0.29999999999999993, -0.8400000000000001, -1.9000000000000004, -1.9600000000000002, -1.8800000000000001, -1.8800000000000001]

    assert avg_hyd == cor_avg_hyd


